@using System.Linq
@model List<BW4_BE_Grp2.Models.Ordini>

<div class="cart-container row">
    <div class="cart-items order-1 order-md-0 col-12 col-md-7 col-lg-8">
        <h2 class="cart-title">Carrello</h2>

        @if (Model == null || !Model.Any())
        {
            <p class="empty-cart">Il tuo carrello è vuoto.</p>
        }
        else
        {
            @foreach (var ordini in Model)
            {
                <div class="cart-item">
                    <div class="cart-item-left">
                        @if (ordini.Prodotto != null)
                        {
                            <img src="@ordini.Prodotto.Immagine" alt="@ordini.Prodotto.Nome" class="product-image" style="object-fit:contain" />
                        }
                        else
                        {
                            <div class="product-placeholder">Nessuna immagine disponibile</div>
                        }
                    </div>
                    <div class="cart-item-right">
                        <h3 class="product-name">@ordini.Prodotto?.Nome</h3>
                        <p class="product-description">Garanzia: 12 mesi</p>
                        <p class="product-price">@ordini.PrezzoUnita €</p>
                        <div class="quantity-control">
                            <a asp-controller="Carrello" asp-action="RemoveQuantity" asp-route-item="@ordini.IdProdotto" asp-route-cart="@ordini.IdCarrello" class="quantity-btn">-</a>
                            <span class="quantity">@ordini.Quantita</span>
                            <a asp-controller="Carrello" asp-action="AddQuantity" asp-route-item="@ordini.IdProdotto" asp-route-cart="@ordini.IdCarrello"  class="quantity-btn">+</a>
                        </div>
                    </div>
                    <div class="">
                        <form asp-action="Rimuovi" method="post" class="remove-form">
                            <input type="hidden" name="idProdotto" value="@ordini.IdProdotto" />
                            <button type="submit" class="remove-button fs-4"><i class="bi bi-trash"></i></button>
                        </form>

                    </div>
                </div>
            }
        }
    </div>

    <div class="order-summary order-0 order-md-1 col-12 col-md-4 col-lg-3 mb-4 mb-md-0">
        <h2 class="summary-title">Riepilogo Ordine</h2>
        <div class="summary-details">
            <p>1 Articolo</p>
            <p>Spedizione: <span class="shipping">Inclusa</span></p>
        </div>
        <p class="total-price">Somma totale: <strong>@(Model?.Sum(o => o.PrezzoUnita * o.Quantita) ?? 0) €</strong></p>
        <p class="price-includes">Il prezzo include IVA</p>
        <button class="checkout-button">Vai avanti</button>
    </div>
</div>